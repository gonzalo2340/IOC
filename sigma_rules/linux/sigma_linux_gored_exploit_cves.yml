title: GoRed Exploitation of Known Vulnerabilities
id: d9c7a2f5-8e1b-4a6f-b7d3-9f2e8d6a5c3b
status: experimental
description: Detects exploitation attempts of known vulnerabilities used by ExCobalt/GoRed for privilege escalation and initial access
references:
  - An√°lisis PT
author: FERNANDEZ GONZALO
date: 2025/04/15
tags:
  - attack.privilege_escalation
  - attack.t1068
  - attack.initial_access
  - attack.t1190
  - gored
  - excobalt
  - cve
  - exploit
logsource:
  product: linux
  category: process_creation
detection:
  # CVE-2021-3156 (Baron Samedit in sudo)
  selection_sudo_exploit:
    CommandLine|contains|all:
      - 'sudo'
      - '\' '
    Hashes|contains:
      - 'MD5=489fbca25049e5fab9dca10541e33214'
      - 'SHA1=91eeab83ddcd82a77804f2e5572d849dc846b225'
      - 'SHA256=9ec7495bb6d3a7d3bfd5d5ae9e704d0f42f3136166652a5576f15d0379126d75'
    OriginalFileName: '3156.zip'
  
  # CVE-2021-4034 (Pwnkit in pkexec)
  selection_pkexec_exploit:
    CommandLine|contains:
      - 'pkexec'
      - 'GCONV_PATH='
    Hashes|contains:
      - 'MD5=a5fa43f822b6dd88298371232d49c597'
      - 'SHA1=1aa5b4deae98f707b0a529d97fd8e7f2372c549e'
      - 'SHA256=7d2ae888fd06b811f6ba880c1fec3f37d49d50e0716de1b28f978240abe7795e'
    OriginalFileName: '4034'
  
  # CVE-2019-13272 (ptrace in Linux)
  selection_ptrace_exploit:
    CommandLine|contains:
      - 'ptrace'
      - 'PTRACE_'
      - '/proc/self/mem'
  
  # Generic exploit file detection
  selection_exploit_files:
    Image|endswith:
      - '/3156'
      - '/4034'
    CommandLine|contains:
      - 'CVE-2021-3156'
      - 'CVE-2021-4034'
      - 'CVE-2019-13272'
      - 'CVE-2022-2586'
  condition: 1 of selection_*
falsepositives:
  - Security research and testing
  - Penetration testing activities
  - System administrators using legitimate tools with similar patterns
level: critical
